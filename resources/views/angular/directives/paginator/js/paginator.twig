angular.module('app').directive('paginator',[function(){
    return {
        templateUrl: 'angular/directives/paginator-paginator.html',
        restrict: 'E',
        scope: {
            onChangePage:    '&',
            itemsByPage:     '=',
            onPage:          '=',
            totalItems:      '=',
            pagesByRotatore: '='
        },
        link: function($scope, $element, $attrs){

            $scope.onChangePage();

            $scope.changed = function(){
                $scope.onChangePage();
            }



            /*
            $scope.total_pages = 0;

            $scope.classActive = function(page){
                var ret = ($scope.onPage == page);
                console.log('classActive '+ret +' - page: '+page+' - Onpage: '+$scope.onPage);
                return ($scope.onPage == page);
            }

            $scope.setOnPage = function(onPage){

                if(onPage >  $scope.total_pages){
                    return null;
                }

                if(onPage < 1){
                    return null;
                }
                
                //guardamos parte entera pagina actual / paginas por rotatore
                $scope.aux1 = Math.trunc(onPage/$scope.pagesByRotatore);
                //guardamos resto pagina actual / paginas por rotatore
                $scope.aux2 = (onPage%$scope.pagesByRotatore);

                $scope.from         = 1;
                $scope.to           = 0;

                if( ($scope.aux1 == 0) || (($scope.aux1==1) && $scope.aux2==0)) {
                    $scope.from    = 1;
                }else{
                    if(($scope.aux1>1) && ($scope.aux2==0)){
                        $scope.from = (($scope.aux1-1)*$scope.pagesByRotatore)+1;
                    }else{
                        $scope.from    = ($scope.aux1 * $scope.pagesByRotatore)+1;
                    }
                }

                //from + (paginas por rotatore -1)
                $scope.to = $scope.from + ($scope.pagesByRotatore-1); 
                $scope.to = ($scope.to < $scope.total_pages) ? $scope.to : $scope.total_pages;

                console.log('onPage:'+onPage,' - pagesByRotatore: '+$scope.pagesByRotatore,' - aux1: '+$scope.aux1+ '- aux2: '+$scope.aux2+' - '+onPage/$scope.pagesByRotatore ,' - From '+$scope.from,' - To: '+$scope.to);

                
                //En caso de salto rotatore prev
                if(onPage < $scope.from){
                    $scope.pages();
                }
                
                //En caso de salto rotatore max
                if(onPage > $scope.to){
                    $scope.pages();
                }

                
                $scope.disablePrev  = (onPage == 1);
                $scope.disableNext  = (onPage == $scope.total_pages);
                $scope.showFrom     = onPage*$scope.itemsByPage;
                $scope.showTo       = $scope.showFrom+$scope.itemsByPage;

                $scope.onPage = onPage;
            }
            
            $scope.pages = function(){

                var input       = [];
                for (var i = $scope.from; i <= $scope.to; i += 1){
                    input.push(i);
                }
                return(input);
            }

            $scope.init = function(){

                $scope.totalItems       = $scope.totalItems      || 0;
                $scope.elementsByPage   = $scope.elementsByPage  || 10;
                $scope.onPage           = $scope.onPage          || 1;
                $scope.pagesByRotatore  = $scope.pagesByRotatore || 5;

                $scope.total_pages      = Math.ceil($scope.totalItems/$scope.itemsByPage);
                $scope.setOnPage($scope.onPage);
                //console.log($scope.elementsByPage, $scope.actualPage, $scope.totalItems, $scope.pages);    
            }
            $scope.init();

            */
            
        }
    };
}]);